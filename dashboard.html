<!-- === DASHBOARD MODULE === -->
<!-- Version: Beta v1 | Date: 07 NOV 2025 -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard - Aviation Capital Simulator</title>
  <link rel="stylesheet" href="styles.css?v=3.1" />
  <style>
    /* === DASHBOARD STYLE (ACS CLEAN BETA) === */
    body {
      margin: 0;
      background-color: #081530;
      color: white;
      font-family: "Segoe UI", sans-serif;
    }

    /* === GLOBAL HEADER (ACS Clean Alignment) === */
    .acs-header {
      position: fixed;
      top: 0;
      width: 100%;
      background-color: #0a1433;
      color: white;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.8rem 2rem;
      border-bottom: 2px solid #FFB300;
      z-index: 1000;
      box-sizing: border-box;
    }

    .acs-logo {
      display: flex;
      align-items: center;
      gap: 0.6rem;
    }

    .acs-logo img {
      height: 40px;
    }

    .acs-logo h1 {
      font-size: 1.1rem;
      color: #FFB300;
      margin: 0;
      letter-spacing: 0.5px;
    }

    .acs-nav {
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      flex: 1;
    }

    .acs-nav a {
      color: white;
      text-decoration: none;
      font-size: 0.95rem;
      transition: 0.3s;
    }

    .acs-nav a:hover,
    .acs-nav a.active {
      color: #FFB300;
      text-shadow: 0 0 6px rgba(255,179,0,0.6);
    }

    .acs-auth {
      margin-right: 1rem;
    }

    .logout-btn {
      color: #FFB300;
      border: 1px solid #FFB300;
      padding: 0.3rem 0.8rem;
      border-radius: 6px;
      text-decoration: none;
      font-size: 0.9rem;
      transition: 0.3s;
    }

    .logout-btn:hover {
      background-color: #FFB300;
      color: #081530;
    }

    .acs-clock-header {
  font-family: 'Orbitron', 'Consolas', monospace;
  color: #00ff80; /* Verde Airbus tipo cockpit */
  font-weight: bold;
  background: rgba(0, 255, 128, 0.08);
  padding: 0.3rem 0.8rem;
  border-radius: 6px;
  font-size: 0.9rem;
  margin-left: 1rem;
}

    .finance-panels {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
      margin-top: 6rem; /* ajuste para header fijo */
    }

    .panel {
      background: #0e1b3c;
      border-radius: 10px;
      padding: 1.2rem 1.4rem;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.4);
      transition: transform 0.2s ease;
    }

    .panel:hover {
      transform: scale(1.02);
    }

    .panel h3 {
      color: #FFB300;
      margin-bottom: 0.8rem;
    }

    .panel p {
      color: #ddd;
      font-size: 1rem;
      line-height: 1.4;
    }

    .acs-btn {
      background-color: #00a86b;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 8px 14px;
      margin-top: 0.8rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s ease;
    }

    .acs-btn:hover {
      background-color: #007d4e;
    }

    .aircraft-list, .alert-list {
      list-style: none;
      padding-left: 0;
    }

    .aircraft-list li, .alert-list li {
      margin: 6px 0;
    }

    .aircraft-list a {
      color: #FFB300;
      text-decoration: none;
    }

    .aircraft-list a:hover {
      text-decoration: underline;
    }

    .positive {
      color: #00d17a;
      font-weight: 600;
    }

    .alert-list li {
      color: #ff9b00;
    }

    canvas {
      background: rgba(255,255,255,0.03);
      border-radius: 6px;
      margin-top: 0.5rem;
    }

    #welcomeMessage span {
      color: #FFB300;
      text-shadow: 0 0 6px rgba(255, 179, 0, 0.4);
      letter-spacing: 0.5px;
    }

    /* === GROWTH MODAL === */
    #growthModal {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.7);
      display: none;
      align-items: center; justify-content: center;
      z-index: 1000;
    }

    #growthModalContent {
      background: #0b1c3f;
      border: 1px solid #FFB300;
      border-radius: 12px;
      padding: 1.5rem 2rem;
      text-align: center;
      width: 420px;
      box-shadow: 0 0 15px rgba(255,179,0,0.4);
    }

    #growthModal h3 {
      color: #FFB300;
      margin-bottom: 1rem;
    }
  </style>
</head>

<body>
  <!-- ===== HEADER ===== -->
  <header class="acs-header">
    <div class="acs-logo">
      <img src="acs_logo.png" alt="ACS Logo" />
      <h1>Aviation Capital Simulator</h1>
    </div>

    <nav class="acs-nav">
      <a href="dashboard.html" class="active">Main</a>
      <a href="finance.html">Finance</a>
      <a href="aircraft.html">Aircraft</a>
      <a href="routes.html">Routes</a>
      <a href="hr.html">HR</a>
      <a href="forum.html">Forum</a>
      <a href="support.html">Support</a>
    </nav>

    <div class="acs-auth">
      <a href="#" class="logout-btn" onclick="handleLogout()">Logout</a>
    </div>

    <div class="acs-clock-header" id="acs-clock">00:00 ‚Äî 01 JAN 2025</div>
  </header>

  <!-- ===== MAIN ===== -->
  <main class="acs-main">
    <h2 id="welcomeMessage">Welcome to <span>ATLAS (ATL)</span></h2>
    <p id="airlineSub"><span>üá∞üá¨</span> Kyrgyzstan ‚Äî Cargo Operations</p>
    <p class="sub">Your command center for managing fleets, routes, staff and capital.</p>
    <p id="baseInfo" style="color:#FFB300; font-weight:600; margin-top:-0.5rem;"></p>

    <section class="finance-panels">
      <!-- ‚úàÔ∏è Top Earning Aircraft -->
      <div class="panel">
        <h3>‚úàÔ∏è Top Earning Aircraft</h3>
        <ul id="topAircraftList" class="aircraft-list">
          <li><a href="aircraft_profile.html?id=EC-DDR">A320 (EC-DDR)</a> ‚Äî <span class="positive">+ $12,450</span></li>
          <li><a href="aircraft_profile.html?id=EI-KAV">B737-400 (EI-KAV)</a> ‚Äî <span class="positive">+ $9,780</span></li>
          <li><a href="aircraft_profile.html?id=TC-ALM">E190 (TC-ALM)</a> ‚Äî <span class="positive">+ $8,230</span></li>
        </ul>
      </div>

      <!-- üìä Finance -->
      <div class="panel">
        <h3>üìä Finance</h3>
        <p>Access your company‚Äôs monthly and weekly growth overview.</p>
        <button class="acs-btn" onclick="window.location.href='monthly_growth.html'">Open</button>
      </div>

      <!-- üíº Company Value -->
      <div class="panel">
        <h3>üíº Company Value</h3>
        <p>Total assets: <strong id="companyValue">$78.5M</strong></p>
        <p>Includes fleet, credits, and investments.</p>
        <button class="acs-btn" onclick="window.location.href='company_value.html'">Open</button>
      </div>

      <!-- ‚öôÔ∏è Setting -->
      <div class="panel">
        <h3>‚öôÔ∏è Settings</h3>
        <p>Manage system preferences, theme, and data synchronization.</p>
        <button class="acs-btn" onclick="window.location.href='setting.html'">Open Setting</button>
      </div>

      <!-- üì∞ Global News & Events -->
      <div class="panel">
        <h3>üì∞ Global News & Events</h3>
        <p id="newsTeaser">
          <strong>‚ÄúOil prices surge after conflict in the Middle East.‚Äù</strong><br>
          Passenger demand drops 4% this week.
        </p>
        <button class="acs-btn" onclick="window.location.href='events.html'">Read More</button>
      </div>

      <!-- ‚ö†Ô∏è Operational Alerts -->
      <div class="panel">
        <h3>‚ö†Ô∏è Operational Alerts</h3>
        <ul class="alert-list" id="alertsList">
          <li>Maintenance due: <strong>B737-400 (EI-KAV)</strong></li>
          <li>Loan repayment in 2 days</li>
          <li>Low credits warning</li>
        </ul>
        <button class="acs-btn" onclick="window.location.href='alerts_center.html'">Open Center</button>
      </div>

      <!-- üí† Credits -->
      <div class="panel">
        <h3>üí† Credits</h3>
        <p><strong id="creditsAmount">2,450 AC$</strong> available</p>
        <button class="acs-btn" onclick="window.location.href='buy_credits.html'">Buy</button>
      </div>
    </section>
  </main>

  <!-- === WEEKLY GROWTH MODAL === -->
  <div id="growthModal">
    <div id="growthModalContent">
      <h3>üìà Company Weekly Growth</h3>
      <canvas id="modalGrowthChart" width="360" height="160"></canvas>
      <br>
      <button class="acs-btn" onclick="closeGrowthModal()">Close</button>
    </div>
  </div>

  <!-- ===== FOOTER ===== -->
  <footer class="acs-footer">
    <p>¬© 2025 Aviation Capital Simulator. All rights reserved.</p>
  </footer>

  <!-- ===== SCRIPTS ===== -->
    <!-- ===== SCRIPTS ===== -->
  <script>
    // üåç Flag emoji generator
    function getFlagEmoji(country) {
      if (!country) return "üåç";
      const isoMap = {
        "Kyrgyzstan":"KG","United States":"US","United Kingdom":"GB","Spain":"ES",
        "Russia":"RU","Brazil":"BR","Argentina":"AR","Mexico":"MX","France":"FR",
        "Germany":"DE","Italy":"IT","Japan":"JP","China":"CN","India":"IN",
        "Canada":"CA","Australia":"AU","Chile":"CL","Peru":"PE","South Korea":"KR",
        "Saudi Arabia":"SA","South Africa":"ZA","United Arab Emirates":"AE"
      };
      const code = isoMap[country] || country.slice(0,2).toUpperCase();
      return String.fromCodePoint(...[...code].map(c => 0x1F1E6 - 65 + c.charCodeAt()));
    }

    // üìä Draw mini growth chart
    (function drawGrowth() {
      const c = document.getElementById("growthChart");
      if (!c) return;
      const ctx = c.getContext("2d");
      ctx.lineWidth = 2;
      ctx.strokeStyle = "#FFB300";
      ctx.beginPath();
      ctx.moveTo(10, 90);
      ctx.lineTo(50, 60);
      ctx.lineTo(90, 70);
      ctx.lineTo(130, 40);
      ctx.lineTo(170, 55);
      ctx.lineTo(210, 30);
      ctx.stroke();
    })();

    // === MODAL LOGIC ===
    function openGrowthModal() {
      document.getElementById("growthModal").style.display = "flex";
      const ctx = document.getElementById("modalGrowthChart").getContext("2d");
      ctx.clearRect(0, 0, 360, 160);
      ctx.strokeStyle = "#FFB300";
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.moveTo(20, 130);
      ctx.lineTo(70, 100);
      ctx.lineTo(120, 110);
      ctx.lineTo(180, 70);
      ctx.lineTo(240, 90);
      ctx.lineTo(320, 50);
      ctx.stroke();
    }
    function closeGrowthModal() {
      document.getElementById("growthModal").style.display = "none";
    }

    // üö™ Logout
    function handleLogout() {
      alert("üëã Session closed. See you soon, Captain!");
      window.location.href = "login.html";
    }

    // üè¢ Load airline and base info (ACS Unified)
    document.addEventListener("DOMContentLoaded", () => {
      // --- Primary load ---
      let user = JSON.parse(localStorage.getItem("ACS_User") || "{}");
      let airline = JSON.parse(localStorage.getItem("ACS_Airline") || "{}");
      let base = JSON.parse(localStorage.getItem("ACS_Base") || "{}");

      // ‚úÖ Fallbacks for backward compatibility
      if (!user || !user.name) user = JSON.parse(localStorage.getItem("ACS_activeUser") || "{}");
      if (!airline || !airline.name) airline = user.airline || {};
      if (!base || !base.city) base = airline.base || {};

      // --- Mostrar mensaje principal ---
      if (airline.name && airline.iata) {
        const welcome = document.getElementById("welcomeMessage");
        if (welcome) welcome.innerHTML = `Welcome to <span>${airline.name} (${airline.iata})</span>`;
      }

      // --- Pa√≠s y Base (sin ‚ÄòPassenger‚Äô) ---
      const sub = document.getElementById("airlineSub");
      if (sub) {
        const flag = getFlagEmoji(airline.country || base.country || "World");
        const country = airline.country || base.country || "Unknown";
        const baseCity = base.city || base.name || "";
        const baseCode = base.airport || base.icao || base.code || "";
        const baseText = (baseCity || baseCode) ? `Base: ${baseCity} (${baseCode})` : "Base: Unassigned Base";
        sub.innerHTML = `${flag} ${country} ‚Äî ${baseText}`;
      }

      console.log("‚úÖ ACS Dashboard loaded:", { user, airline, base });
    });
  </script>

  <!-- (cerrado el bloque anterior) AHORA s√≠ va el externo: -->
  <script src="finance.js?v=1.0.0"></script>

<!-- === Reloj cockpit Airbus (modo simulador) === -->
<script>
window.addEventListener("load", () => {
  const c = document.getElementById("acs-clock");
  if (!c) return;

  let simTime = new Date();

  function refreshClock() {
    simTime.setMinutes(simTime.getMinutes() + 1);
    const hh = String(simTime.getHours()).padStart(2, "0");
    const mm = String(simTime.getMinutes()).padStart(2, "0");
    const date = simTime.toDateString().toUpperCase();
    c.textContent = `${hh}:${mm} ‚Äî ${date}`;
  }

  refreshClock();
  setInterval(refreshClock, 1000);
});
</script>

</body>
</html>
