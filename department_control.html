<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Department Control Center - Aviation Capital Simulator</title>
  <link rel="stylesheet" href="styles.css?v=3.1" />
  <style>
    /* === DEPARTMENT CONTROL CENTER (ACS) === */
    body {
      margin: 0;
      background-color: #081530;
      color: white;
      font-family: "Segoe UI", sans-serif;
    }

    h2 {
      text-align: center;
      color: #FFB300;
      margin-top: 6rem; /* ‚úÖ Ajuste por header fijo */
      margin-bottom: 0.4rem;
    }

    p.sub {
      text-align: center;
      color: #ccc;
      margin-bottom: 2rem;
    }

    .control-panel {
      max-width: 1150px;
      margin: 2rem auto;
      background: #0b1c3f;
      border-radius: 12px;
      padding: 1.5rem 2rem;
      border: 1px solid rgba(255,179,0,0.25);
      box-shadow: 0 0 15px rgba(0,0,0,0.4);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }

    th, td {
      padding: 0.7rem;
      text-align: left;
    }

    th {
      background-color: #102040;
      color: #FFB300;
      border-bottom: 2px solid #FFB300;
    }

    tr { border-bottom: 1px solid #FFB300; }

    .salary { color: #ff6464; font-weight: 600; }
    .staff { color: #00d17a; font-weight: 600; }
    .morale { color: #00d17a; font-weight: 600; }

    .btn {
      border: none;
      border-radius: 6px;
      padding: 6px 10px;
      margin-left: 4px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s ease;
    }

    .btn-bonus { background-color: #00a86b; color: #fff; }
    .btn-bonus:hover { background-color: #007d4e; }

    .btn-hire { background-color: #007bff; color: #fff; }
    .btn-hire:hover { background-color: #005fcc; }

    .btn-adjust { background-color: #ffb300; color: #000; }
    .btn-adjust:hover { background-color: #e4a000; }

    .btn-transfer { background-color: #87b8ff; color: #000; }
    .btn-transfer.disabled { background-color: #444a60; color: #888; cursor: not-allowed; }

    .btn-dismiss { background-color: #000; color: #fff; }
    .btn-dismiss:hover { background-color: #222; }

    tfoot td {
      border-top: 2px solid #FFB300;
      font-weight: bold;
      text-align: right;
      padding-top: 1rem;
    }

    /* === MODALS === */
    .acs-modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.7);
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }

    .acs-modal-content {
      background: #0b1c3f;
      border: 1px solid #FFB300;
      border-radius: 12px;
      padding: 1.5rem 2rem;
      width: 400px;
      text-align: center;
      box-shadow: 0 0 15px rgba(255,179,0,0.4);
      position: relative;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .close-modal {
      background: none;
      border: none;
      color: #aaa;
      font-size: 1.2rem;
      cursor: pointer;
      position: absolute;
      top: 10px;
      right: 20px;
    }

    input[type="range"], input[type="number"], select {
      width: 80%;
      margin: 1rem 0;
      padding: 0.3rem;
      border-radius: 6px;
      border: 1px solid #FFB300;
      background: #102040;
      color: white;
    }

    .modal-btn {
      background-color: #00a86b;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 8px 16px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 1rem;
      transition: background 0.2s ease;
    }

    .modal-btn:hover { background-color: #007d4e; }

    /* === TOTAL PAYROLL STYLE === */
    #totalPayroll {
      color: #FFB300;
      text-shadow: 0 0 8px rgba(255, 179, 0, 0.4);
      font-weight: 600;
      font-size: 1.1rem;
      letter-spacing: 0.5px;
    }

    /* ‚úÖ Reloj cockpit Airbus */
    .acs-clock-header {
      font-family: 'Orbitron', 'Consolas', monospace;
      color: #00ff80;
      font-weight: bold;
      background: rgba(0, 255, 128, 0.08);
      padding: 0.3rem 0.8rem;
      border-radius: 6px;
      font-size: 0.9rem;
      margin-left: 1rem;
    }
  </style>
</head>

<body>
  <!-- ===== HEADER ===== -->
  <header class="acs-header">
    <div class="acs-logo">
      <img src="acs_logo.png" alt="ACS Logo" />
      <h1>Aviation Capital Simulator</h1>
    </div>

    <nav class="acs-nav">
      <a href="dashboard.html">Main</a>
      <a href="finance.html">Finance</a>
      <a href="aircraft.html">Aircraft</a>
      <a href="routes.html">Routes</a>
      <a href="market.html">Market</a>
      <a href="hr.html" class="active">HR</a>
      <a href="forum.html">Forum</a>
      <a href="profile.html">Profile</a>
      <a href="support.html">Support</a>
    </nav>

    <div class="acs-auth">
      <a href="#" class="logout-btn" onclick="handleLogout()">Logout</a>
    </div>

    <div class="acs-clock-header" id="acs-clock">00:00 ‚Äî 01 JAN 2025</div>
  </header>

  <!-- ===== MAIN ===== -->
  <main class="acs-main">
    <h2>üè¢ Department Control Center</h2>
    <p class="sub">Manage all departments, staff, salaries, morale and workforce actions.</p>

    <section class="control-panel">
      <table id="deptTable">
        <thead>
          <tr>
            <th>Department</th>
            <th>Staff</th>
            <th>Salary</th>
            <th>Morale</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="departmentRows"></tbody>
        <tfoot>
          <tr>
            <td colspan="5" id="totalPayroll">Total Monthly Payroll: $0</td>
          </tr>
        </tfoot>
      </table>
    </section>
  </main>

  <!-- ===== MODALS ===== -->
  <div class="acs-modal" id="bonusModal">
    <div class="acs-modal-content">
      <button class="close-modal" onclick="closeModal('bonusModal')">‚úñ</button>
      <h3>Assign Department Bonus</h3>
      <p id="bonusDeptName">Department</p>
      <input type="range" min="20" max="100" step="10" value="20" id="bonusRange">
      <p>Bonus: <span id="bonusValue">20%</span></p>
      <p>Estimated Cost: <span id="bonusCost">0</span> USD</p>
      <button class="modal-btn" onclick="confirmBonus()">Confirm Bonus</button>
    </div>
  </div>

  <div class="acs-modal" id="hireModal">
    <div class="acs-modal-content">
      <button class="close-modal" onclick="closeModal('hireModal')">‚úñ</button>
      <h3>Hire New Staff</h3>
      <p id="hireDeptName">Department</p>
      <input type="number" id="hireCount" min="1" max="50" value="1">
      <p>Estimated Cost: <span id="hireCost">0</span> USD</p>
      <button class="modal-btn" onclick="confirmHire()">Confirm Hire</button>
    </div>
  </div>

  <div class="acs-modal" id="salaryModal">
    <div class="acs-modal-content">
      <button class="close-modal" onclick="closeModal('salaryModal')">‚úñ</button>
      <h3>Adjust Department Salary</h3>
      <p id="salaryDeptName">Department</p>
      <input type="range" min="5" max="120" step="5" value="100" id="salaryRange">
      <p>Adjustment: <span id="salaryValue">100%</span></p>
      <p>New Payroll Estimate: <span id="salaryNewTotal">0</span> USD</p>
      <button class="modal-btn" onclick="confirmSalary()">Apply Adjustment</button>
    </div>
  </div>

  <div class="acs-modal" id="dismissModal">
    <div class="acs-modal-content">
      <button class="close-modal" onclick="closeModal('dismissModal')">‚úñ</button>
      <h3>Confirm Dismissal</h3>
      <p id="dismissDeptName">Enter number of staff to dismiss:</p>
      <input type="number" id="dismissCount" min="1" max="50" value="1">
      <button class="modal-btn" onclick="confirmDismiss()">Confirm</button>
    </div>
  </div>

  <footer class="acs-footer">
    <p>¬© 2025 Aviation Capital Simulator. All rights reserved.</p>
  </footer>

  <!-- ===== SCRIPT ===== -->
  <script>
    const user = JSON.parse(localStorage.getItem("ACS_User"));
    const CEOname = user ? user.name : "CEO";

    const departments = [
      `Airline CEO - ${CEOname}`,
      "High Level Management",
      "Middle Level Management",
      "Economics and Finance",
      "Corporate Communications",
      "Human Resources",
      "Quality Department",
      "Safety and Security",
      "Customer Services",
      "Flight Operations Division",
      "Technical Services and Maintenance",
      "Ground Handling",
      "Route Strategies Department",
      "Pilots (Small A/C)",
      "Pilots (Medium A/C)",
      "Pilots (Large A/C)",
      "Pilots (Very Large A/C)",
      "Cabin Crew"
    ];

    const deptTable = document.getElementById("departmentRows");

    departments.forEach(dept => {
      const isCrew = dept.includes("Pilot") || dept.includes("Cabin");
      const isCEO = dept.includes("CEO");

      deptTable.innerHTML += `
        <tr>
          <td>${dept}</td>
          <td class="staff" data-staff="100">${isCEO ? "-" : "100 / 100"}</td>
          <td class="salary" data-salary="${isCEO ? "15000" : "3000"}">$${isCEO ? "15,000" : "3,000"}</td>
          <td class="morale" data-morale="100">100%</td>
          <td>
            ${
              isCEO
                ? `<button class="btn btn-adjust" onclick="openModal('salaryModal')">üìà</button>`
                : `
                  <button class="btn btn-bonus" onclick="openModal('bonusModal')">üíµ</button>
                  <button class="btn btn-hire" onclick="openModal('hireModal')">üßç</button>
                  <button class="btn btn-adjust" onclick="openModal('salaryModal')">üìà</button>
                  <button class="btn btn-transfer ${isCrew ? '' : 'disabled'}" ${isCrew ? '' : 'disabled'} onclick="openModal('transferModal')">üîÅ</button>
                  <button class="btn btn-dismiss" onclick="openModal('dismissModal')">‚ùå</button>`
            }
          </td>
        </tr>`;
    });

    function openModal(id) { document.getElementById(id).style.display = "flex"; }
    function closeModal(id) { document.getElementById(id).style.display = "none"; }

    document.getElementById("salaryRange").addEventListener("input", function () {
      document.getElementById("salaryValue").textContent = this.value + "%";
    });

    function handleLogout() {
      alert("üëã Session closed. See you soon, Captain!");
      window.location.href = "login.html";
    }

    function confirmBonus() { closeModal('bonusModal'); }
    function confirmHire() { closeModal('hireModal'); calculateTotalPayroll(); }
    function confirmSalary() { closeModal('salaryModal'); calculateTotalPayroll(); }
    function confirmDismiss() { closeModal('dismissModal'); calculateTotalPayroll(); }

    function calculateTotalPayroll() {
      let total = 0;
      document.querySelectorAll("#departmentRows tr").forEach(row => {
        const salary = parseFloat(row.querySelector(".salary")?.dataset.salary || "0");
        if (!isNaN(salary)) total += salary;
      });
      document.getElementById("totalPayroll").textContent =
        "Total Monthly Payroll: $" + total.toLocaleString();
    }

    window.addEventListener("DOMContentLoaded", calculateTotalPayroll);
  </script>

  <!-- ‚úÖ Reloj cockpit Airbus -->
  <script src="time_engine.js?v=1.2"></script>
</body>
</html>
