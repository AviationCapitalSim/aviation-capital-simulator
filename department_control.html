<!-- ============================================================
     === DEPARTMENT CONTROL CENTER ‚Äî Qatar Luxury Edition ========
     === Version: v2 | Date: 24 NOV 2025 =========================
     ============================================================ -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Department Control Center - Aviation Capital Simulator</title>

  <!-- ======== ACS Styles ======== -->
  <link rel="stylesheet" href="styles.css?v=3.1" />

  <!-- ======== ACS Favicons ======== -->
  <link rel="icon" type="image/png" sizes="16x16" href="acs_logo_16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="acs_logo_32.png">
  <link rel="icon" type="image/png" sizes="64x64" href="acs_logo_64.png">
  <link rel="apple-touch-icon" href="acs_logo_180.png">

<style>
/* ============================================================
     === GLOBAL VISUALS ‚Äî Qatar Luxury ===========================
   ============================================================ */

body {
  margin: 0;
  background-color: #081530;
  color: white;
  font-family: "Poppins", sans-serif;
}

/* ============================================================
     === HEADER (Exact Copy from Dashboard) =====================
   ============================================================ */

.acs-header {
  position: fixed;
  top: 0;
  width: 100%;
  backdrop-filter: blur(9px);
  background: rgba(12,23,50,0.45);
  padding: 0.8rem 2rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 2px solid #ffb300;
  z-index: 5000;
}

.acs-left {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.acs-left img {
  height: 46px;
}

.acs-left h1 {
  font-size: 1.15rem;
  margin: 0;
  color: #ffb300;
  letter-spacing: 0.5px;
}

.acs-nav {
  flex: 1;
  display: flex;
  justify-content: center;
  gap: 2rem;
}

.acs-nav a {
  position: relative;
  font-size: 1rem;
  letter-spacing: 0.4px;
  color: #dbe4ff; 
  text-decoration: none;
  transition: 0.25s ease;
  padding-bottom: 6px;
}

.acs-nav a:hover,
.acs-nav a.active {
  color: #ffb300;
  text-shadow: 0 0 6px rgba(255,179,0,0.6);
}

.acs-nav a.active::after,
.acs-nav a:hover::after {
  content: "";
  position: absolute;
  bottom: -8px;
  left: 0;
  width: 100%;
  height: 2px;
  background: linear-gradient(to right, #ffb300, #ffe7a0);
  border-radius: 2px;
}

.acs-right {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.logout-btn {
  padding: 0.45rem 1.1rem;
  border: 1px solid #ffb300;
  border-radius: 12px;
  background: rgba(255,179,0,0.05);
  color: #ffb300;
  font-weight: 600;
  cursor: pointer;
  text-decoration: none;
}

.logout-btn:hover {
  background: #ffb300;
  color: #0c1f3c;
}

.acs-clock-header {
  font-family: "Orbitron", monospace;
  padding: 0.4rem 0.8rem;
  background: rgba(0,255,128,0.08);
  border-radius: 8px;
  font-size: 0.95rem;
  color: #00ff80;
}

/* ============================================================
     === MAIN LAYOUT ===========================================
   ============================================================ */

.acs-main {
  padding: 110px 2rem 70px;
  text-align: center;
}

/* T√≠tulo estilo Dashboard */
.acs-title {
  font-size: 1.9rem;
  font-weight: 600;
  color: #ffca3a;
  text-shadow: 0 0 12px rgba(255,190,60,0.55);
  letter-spacing: 0.6px;
  margin-bottom: 0.2rem;
}

.acs-sub {
  margin-top: -0.2rem;
  color: #cbd6ff;
  font-size: 1rem;
}

/* ============================================================
     === PREMIUM PANEL (80% width) =============================
   ============================================================ */

.control-panel {
  width: 80%;
  margin: 2rem auto;
  background: linear-gradient(180deg, rgba(20,35,70,0.75), rgba(10,18,40,0.85));
  padding: 2rem;
  border-radius: 22px;
  border: 1px solid rgba(255,179,0,0.15);
  box-shadow: 0 0 25px rgba(0,0,0,0.4);
}

/* ============================================================
     === TABLE ‚Äî Qatar Luxury Dark Premium =====================
   ============================================================ */

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 1rem;
}

th {
  background: #102040;
  color: #ffb300;
  padding: 0.9rem;
  border-bottom: 2px solid #ffb300;
  font-size: 1rem;
}

td {
  padding: 0.8rem;
  font-size: 0.95rem;
  color: #dbe4ff;
  border-bottom: 1px solid rgba(255,179,0,0.15);
}

tr:nth-child(even) {
  background: rgba(255,255,255,0.03);
}

/* Staff, Salary, Morale colors */
.staff { color: #00e28a; font-weight: 600; }
.salary { color: #ff6464; font-weight: 600; }
.morale { color: #8ae2ff; font-weight: 600; }

/* Action buttons */
.btn {
  border: none;
  border-radius: 8px;
  padding: 6px 10px;
  font-weight: 600;
  cursor: pointer;
  margin-right: 4px;
  transition: 0.2s;
}

.btn-bonus { background:#00a86b; color:white; opacity:0.45; cursor:not-allowed; }
.btn-hire { background:#007bff; color:white; }
.btn-adjust { background:#ffb300; color:black; }
.btn-dismiss { background:#000; color:white; }

/* Total Payroll */
#totalPayroll {
  padding-top: 1.2rem;
  font-weight: bold;
  text-align: right;
  font-size: 1.1rem;
  color: #ffca3a;
  text-shadow: 0 0 10px rgba(255,200,60,0.4);
}

/* ============================================================
     === MODALS (sin cambios de funcionalidad) =================
   ============================================================ */

.acs-modal {
  display:none; position:fixed; top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.7);
  align-items:center; justify-content:center;
  z-index:2000;
}

.acs-modal-content {
  background:#0b1c3f;
  border:1px solid #ffb300;
  border-radius:12px;
  padding:1.5rem 2rem;
  width:400px;
  text-align:center;
  box-shadow: 0 0 15px rgba(255,179,0,0.4);
}

/* Close button */
.close-modal {
  background:none;
  border:none;
  color:#aaa;
  font-size:1.2rem;
  cursor:pointer;
  position:absolute;
  top:10px;
  right:20px;
}
/* ============================================================
   === ACS GALACTIC LOAD LEVELER (Qatar Luxury) ================
   ============================================================ */

.load-bar-wrapper {
  display: flex;
  align-items: center;
  gap: 10px;
}

.load-bar {
  width: 140px;
  height: 12px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 10px;
  overflow: hidden;
  border: 1px solid rgba(255, 200, 60, 0.25);
  position: relative;
  box-shadow: 0 0 10px rgba(255,179,0,0.15) inset;
}

.load-fill {
  height: 100%;
  width: 0%;
  border-radius: 10px;
  transition: width 0.5s ease-out;
  background: linear-gradient(90deg,
    rgba(0,255,140,1),
    rgba(0,200,100,1)
  );
  position: relative;
}

/* Galactic pulse line */
.load-fill::after {
  content: "";
  position: absolute;
  top: 0;
  left: -40px;
  width: 40px;
  height: 100%;
  background: rgba(255,255,255,0.25);
  filter: blur(4px);
  animation: loadPulse 3.6s infinite ease-in-out;
}

@keyframes loadPulse {
  0%   { left: -40px; opacity: 0; }
  35%  { opacity: 0.35; }
  50%  { left: 140px; opacity: 0.25; }
  100% { left: 140px; opacity: 0; }
}

/* COLORS by percentage */
.load-critical  { background: linear-gradient(90deg,#ff3b3b,#ff7a7a); }
.load-low       { background: linear-gradient(90deg,#ff8c3b,#ffbd7a); }
.load-medium    { background: linear-gradient(90deg,#ffc93b,#ffe37a); }
.load-high      { background: linear-gradient(90deg,#3bff9d,#6effc4); }

.load-number {
  font-size: 0.85rem;
  color: #dbe4ff;
  font-weight: 600;
}
</style>
</head>

<body>

<!-- ============================================================
     === HEADER ==================================================
     ============================================================ -->
<header class="acs-header">
  <div class="acs-left">
    <img src="acs_logo.png" alt="ACS Logo">
    <h1>Aviation Capital Simulator</h1>
  </div>

  <nav class="acs-nav">
    <a href="dashboard.html">Main</a>
    <a href="finance.html">Finance</a>
    <a href="aircraft.html">Aircraft</a>
    <a href="routes.html">Routes</a>
    <a href="hr.html" class="active">HR</a>
    <a href="forum.html">Forum</a>
  </nav>

  <div class="acs-right">
    <a class="logout-btn" onclick="handleLogout()">Logout</a>
    <div id="acs-clock" class="acs-clock-header">00:00 ‚Äî 01 JAN 2025</div>
  </div>
</header>

<!-- ============================================================
     === MAIN ====================================================
     ============================================================ -->
<main class="acs-main">

  <h2 class="acs-title">üè¢ Department Control Center</h2>
  <p class="acs-sub">Manage all departments, staff, salaries and morale.</p>

  <section class="control-panel">

    <table id="deptTable">
      <thead>
  <tr>
    <th>Department</th>
    <th>Staff</th>
    <th>Load</th> <!-- ‚≠ê NUEVA COLUMNA GAL√ÅCTICA -->
    <th>Salary</th>
    <th>Morale</th>
    <th>Actions</th>
  </tr>
</thead>


      <tbody id="departmentRows"></tbody>

      <tfoot>
        <tr>
          <td colspan="5" id="totalPayroll">Total Monthly Payroll: $0</td>
        </tr>
      </tfoot>

    </table>

  </section>

</main>

<!-- ============================================================
     === MODALS (SIN CAMBIOS) ===================================
     ============================================================ -->

<!-- BONUS -->
<div class="acs-modal" id="bonusModal">
  <div class="acs-modal-content">
    <button class="close-modal" onclick="closeModal('bonusModal')">‚úñ</button>
    <h3>Assign Department Bonus</h3>
    <p id="bonusDeptName">Department</p>
    <input type="range" min="20" max="100" step="10" value="20" id="bonusRange">
    <p>Bonus: <span id="bonusValue">20%</span></p>
    <p>Estimated Cost: <span id="bonusCost">0</span> USD</p>
    <button class="modal-btn" onclick="confirmBonus()">Confirm Bonus</button>
  </div>
</div>

<!-- HIRE -->
<div class="acs-modal" id="hireModal">
  <div class="acs-modal-content">
    <button class="close-modal" onclick="closeModal('hireModal')">‚úñ</button>
    <h3>Hire New Staff</h3>
    <p id="hireDeptName">Department</p>
    <input type="number" id="hireCount" min="1" max="50" value="1">
    <p>Cost: <span id="hireCost">0</span> USD</p>
    <button class="modal-btn" onclick="confirmHire()">Confirm Hire</button>
  </div>
</div>

<!-- ADJUST SALARY -->
<div class="acs-modal" id="salaryModal">
  <div class="acs-modal-content">
    <button class="close-modal" onclick="closeModal('salaryModal')">‚úñ</button>
    <h3>Adjust Department Salary</h3>
    <p id="salaryDeptName">Department</p>
    <input type="range" min="50" max="150" step="5" value="100" id="salaryRange">
    <p>Adjustment: <span id="salaryValue">100%</span></p>
    <button class="modal-btn" onclick="confirmSalary()">Apply Adjustment</button>
  </div>
</div>

<!-- DISMISS -->
<div class="acs-modal" id="dismissModal">
  <div class="acs-modal-content">
    <button class="close-modal" onclick="closeModal('dismissModal')">‚úñ</button>
    <h3>Confirm Dismissal</h3>
    <p id="dismissDeptName">Department</p>
    <input type="number" id="dismissCount" min="1" max="50" value="1">
    <button class="modal-btn" onclick="confirmDismiss()">Confirm</button>
  </div>
</div>

<footer class="acs-footer">
  ¬© 2025 Aviation Capital Simulator. All rights reserved.
</footer>

<!-- ============================================================
     === SCRIPTS ‚Äî SIN CAMBIOS (FUNCIONALIDAD ORIGINAL) =========
     ============================================================ -->

<script src="engine/acs_finance.js"></script>
<script src="engine/acs_hr_engine.js"></script>
<script src="time_engine.js"></script>

<script>
let activeDept = null;
/* ============================================================
   === GALACTIC LOAD BAR BUILDER ==============================
   ============================================================ */
function ACS_HR_renderLoadBar(dep) {
  const staff = dep.staff;
  const required = dep.required || dep.min || 0;

  let pct = required > 0 ? (staff / required) * 100 : 100;
  if (pct > 100) pct = 100;

  let cls = "load-high";
  if (pct < 40) cls = "load-critical";
  else if (pct < 60) cls = "load-low";
  else if (pct < 80) cls = "load-medium";

  return `
    <div class="load-bar-wrapper">
      <div class="load-bar">
        <div class="load-fill ${cls}" style="width:${pct}%"></div>
      </div>
      <span class="load-number">${staff} / ${required}</span>
    </div>
  `;
}
/* LOAD DEPARTMENTS */
function loadDepartments() {
  const rows = document.getElementById("departmentRows");
  rows.innerHTML = "";

  const depts = ACS_HR_getDepartmentsView();

  depts.forEach(dep => {

    if (dep.id === "ceo") {
      rows.innerHTML += `
        <tr>
          <td>${dep.name}</td>
          <td class="staff">${dep.staff}</td>
          <td class="salary">$${dep.salary}</td>
          <td class="morale">${dep.morale}%</td>
          <td><em style="color:#aaa;">No actions available</em></td>
        </tr>
      `;
      return;
    }

    rows.innerHTML += `
  <tr>
    <td>${dep.name}</td>
    <td class="staff">${dep.staff}</td>

    <!-- ‚≠ê NUEVA COLUMNA LOAD GAL√ÅCTICA -->
    <td>${ACS_HR_renderLoadBar(dep)}</td>

    <td class="salary">$${dep.salary}</td>
    <td class="morale">${dep.morale}%</td>
    <td>
      <button class="btn btn-bonus" disabled title="Bonus system coming soon">üíµ</button>
      <button class="btn btn-hire" onclick="openHire('${dep.id}')">üßç</button>
      <button class="btn btn-adjust" onclick="openSalary('${dep.id}')">üìà</button>
      <button class="btn btn-dismiss" onclick="openDismiss('${dep.id}')">‚ùå</button>
    </td>
  </tr>
`;
          <button class="btn btn-bonus" disabled>üíµ</button>
          <button class="btn btn-hire" onclick="openHire('${dep.id}')">üßç</button>
          <button class="btn btn-adjust" onclick="openSalary('${dep.id}')">üìà</button>
          <button class="btn btn-dismiss" onclick="openDismiss('${dep.id}')">‚ùå</button>
        </td>
      </tr>
    `;
  });

  updatePayroll();
}

function updatePayroll() {
  const total = ACS_HR_getTotalPayroll();
  document.getElementById("totalPayroll").textContent =
    "Total Monthly Payroll: $" + total.toLocaleString();
}

function openHire(id) {
  activeDept = id;
  const hr = ACS_HR_load()[id];
  document.getElementById("hireDeptName").textContent = hr.name;
  document.getElementById("hireCount").value = 1;
  document.getElementById("hireCost").textContent = hr.salary.toLocaleString();
  document.getElementById("hireModal").style.display = "flex";
}

function openSalary(id) {
  activeDept = id;
  const hr = ACS_HR_load()[id];
  document.getElementById("salaryDeptName").textContent = hr.name;
  document.getElementById("salaryRange").value = 100;
  document.getElementById("salaryValue").textContent = "100%";
  document.getElementById("salaryModal").style.display = "flex";
}

function openDismiss(id) {
  activeDept = id;
  const hr = ACS_HR_load()[id];
  document.getElementById("dismissDeptName").textContent = hr.name;
  document.getElementById("dismissCount").value = 1;
  document.getElementById("dismissModal").style.display = "flex";
}

function closeModal(id) {
  document.getElementById(id).style.display = "none";
}

function confirmHire() {
  const count = parseInt(document.getElementById("hireCount").value);
  ACS_HR_hire(activeDept, count);
  closeModal('hireModal');
  loadDepartments();
}

function confirmDismiss() {
  const count = parseInt(document.getElementById("dismissCount").value);
  ACS_HR_fire(activeDept, count);
  closeModal('dismissModal');
  loadDepartments();
}

function confirmSalary() {
  const percent = parseInt(document.getElementById("salaryRange").value);
  ACS_HR_adjustSalary(activeDept, percent);
  closeModal('salaryModal');
  loadDepartments();
}

function handleLogout() {
  alert("üëã Session closed. See you soon, Captain!");
  window.location.href = "login.html";
}

window.addEventListener("DOMContentLoaded", () => {
  loadDepartments();
  if (typeof registerTimeListener === "function") {
    registerTimeListener(updateClockDisplay);
    updateClockDisplay();
  }
});
</script>

</body>
</html>
