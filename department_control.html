<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Department Control Center - Aviation Capital Simulator</title>
  <link rel="stylesheet" href="styles.css?v=3.1" />
  <style>
    body {
      margin: 0;
      background-color: #081530;
      color: white;
      font-family: "Segoe UI", sans-serif;
    }

    h2 {
      text-align: center;
      color: #FFB300;
      margin-top: 2rem;
      margin-bottom: 0.4rem;
    }

    p.sub {
      text-align: center;
      color: #ccc;
      margin-bottom: 2rem;
    }

    .control-panel {
      max-width: 1150px;
      margin: 2rem auto;
      background: #0b1c3f;
      border-radius: 12px;
      padding: 1.5rem 2rem;
      border: 1px solid rgba(255,179,0,0.25);
      box-shadow: 0 0 15px rgba(0,0,0,0.4);
    }

    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { padding: 0.7rem; text-align: left; }
    th {
      background-color: #102040;
      color: #FFB300;
      border-bottom: 2px solid #FFB300;
    }
    tr { border-bottom: 1px solid #FFB300; }

    .salary { color: #ff6464; font-weight: 600; }
    .staff { color: #00d17a; font-weight: 600; transition: color 0.3s ease; }
    .morale { color: #00d17a; font-weight: 600; }

    .btn {
      border: none; border-radius: 6px;
      padding: 6px 10px; margin-left: 4px;
      font-weight: 600; cursor: pointer;
      transition: background 0.2s ease;
    }

    .btn-bonus { background-color: #00a86b; color: #fff; }
    .btn-hire { background-color: #007bff; color: #fff; }
    .btn-adjust { background-color: #ffb300; color: #000; }
    .btn-dismiss { background-color: #000; color: #fff; }
    .btn:hover { opacity: 0.85; }

    tfoot td {
      border-top: 2px solid #FFB300;
      font-weight: bold;
      text-align: right;
      padding-top: 1rem;
      color: #FFB300;
      text-shadow: 0 0 8px rgba(255,179,0,0.4);
    }

    /* === MODALS === */
    .acs-modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.7);
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }

    .acs-modal-content {
      background: #0b1c3f;
      border: 1px solid #FFB300;
      border-radius: 12px;
      padding: 1.5rem 2rem;
      width: 400px;
      text-align: center;
      box-shadow: 0 0 15px rgba(255,179,0,0.4);
      position: relative;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .close-modal {
      background: none;
      border: none;
      color: #aaa;
      font-size: 1.2rem;
      cursor: pointer;
      position: absolute;
      top: 10px;
      right: 20px;
    }

    input[type="range"], input[type="number"], select {
      width: 80%;
      margin: 1rem 0;
      padding: 0.3rem;
      border-radius: 6px;
      border: 1px solid #FFB300;
      background: #102040;
      color: white;
    }

    .modal-btn {
      background-color: #00a86b;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 8px 16px;
      font-weight: 600;
      cursor: pointer;
      margin: 0.5rem;
      transition: background 0.2s ease;
    }
    .modal-btn.cancel { background-color: #ff6464; }
    .modal-btn:hover { opacity: 0.85; }
  </style>
</head>

<body>
  <header class="acs-header">
    <div class="acs-logo">
      <img src="acs_logo.png" alt="ACS Logo" />
      <h1>Aviation Capital Simulator</h1>
    </div>
    <nav class="acs-nav">
      <a href="dashboard.html">Main</a>
      <a href="finance.html">Finance</a>
      <a href="aircraft.html">Aircraft</a>
      <a href="routes.html">Routes</a>
      <a href="market.html">Market</a>
      <a href="hr.html">HR</a>
      <a href="forum.html">Forum</a>
      <a href="profile.html">Profile</a>
      <a href="support.html">Support</a>
      <a href="#" class="logout-btn" onclick="handleLogout()">Logout</a>
    </nav>
  </header>

  <main class="acs-main">
    <h2>üè¢ Department Control Center</h2>
    <p class="sub">Manage all departments, staff, salaries, morale and workforce actions.</p>
    <section class="control-panel">
      <table id="deptTable">
        <thead>
          <tr>
            <th>Department</th>
            <th>Staff</th>
            <th>Salary</th>
            <th>Morale</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="departmentRows"></tbody>
        <tfoot>
          <tr>
            <td colspan="5" id="totalPayroll">Total Monthly Payroll: $0</td>
          </tr>
        </tfoot>
      </table>
    </section>
  </main>

  <!-- HIRE Modal -->
  <div class="acs-modal" id="hireModal">
    <div class="acs-modal-content">
      <button class="close-modal" onclick="closeModal('hireModal')">‚úñ</button>
      <h3>Hire New Staff</h3>
      <p id="hireDeptName">Department</p>
      <input type="number" id="hireCount" min="1" max="50" value="1">
      <div>
        <button class="modal-btn" onclick="confirmAction('hire')">Confirm</button>
        <button class="modal-btn cancel" onclick="closeModal('hireModal')">Cancel</button>
      </div>
    </div>
  </div>

  <!-- DISMISS Modal -->
  <div class="acs-modal" id="dismissModal">
    <div class="acs-modal-content">
      <button class="close-modal" onclick="closeModal('dismissModal')">‚úñ</button>
      <h3>Dismiss Staff</h3>
      <p id="dismissDeptName">Department</p>
      <input type="number" id="dismissCount" min="1" max="50" value="1">
      <div>
        <button class="modal-btn" onclick="confirmAction('dismiss')">Confirm</button>
        <button class="modal-btn cancel" onclick="closeModal('dismissModal')">Cancel</button>
      </div>
    </div>
  </div>

  <footer class="acs-footer">
    <p>¬© 2025 Aviation Capital Simulator. All rights reserved.</p>
  </footer>

  <script>
    const user = JSON.parse(localStorage.getItem("ACS_User"));
    const CEOname = user ? user.name : "CEO";

    const departments = [
      "Human Resources", "Flight Operations Division", "Technical Services and Maintenance",
      "Ground Handling", "Cabin Crew"
    ];

    const ACS = {
      time: { minute: 0, hour: 0, day: 1, week: 1 },
      hr: {},
      pendingEffects: []
    };

    departments.forEach(d => {
      ACS.hr[d] = { staff: 100, required: 100, salary: 3000, morale: 100 };
    });

    const table = document.getElementById("departmentRows");

    function renderTable() {
      table.innerHTML = "";
      let total = 0;
      departments.forEach(dep => {
        const d = ACS.hr[dep];
        const color = d.staff < d.required ? "#ff6464" : d.staff > d.required ? "#FFB300" : "#00d17a";
        total += d.salary * d.staff;
        table.innerHTML += `
          <tr>
            <td>${dep}</td>
            <td class="staff" style="color:${color}">${d.staff} / ${d.required}</td>
            <td class="salary" data-salary="${d.salary}">$${d.salary.toLocaleString()}</td>
            <td class="morale">${d.morale}%</td>
            <td>
              <button class="btn btn-hire" onclick="openHire('${dep}')">üßç</button>
              <button class="btn btn-dismiss" onclick="openDismiss('${dep}')">‚ùå</button>
            </td>
          </tr>`;
      });
      document.getElementById("totalPayroll").innerHTML = `Total Monthly Payroll: $${total.toLocaleString()}`;
    }

    renderTable();

    // === MODALS ===
    function openHire(dep) {
      document.getElementById("hireDeptName").textContent = dep;
      openModal("hireModal");
    }
    function openDismiss(dep) {
      document.getElementById("dismissDeptName").textContent = dep;
      openModal("dismissModal");
    }

    function openModal(id) { document.getElementById(id).style.display = "flex"; }
    function closeModal(id) { document.getElementById(id).style.display = "none"; }

    // === Confirm Actions ===
    function confirmAction(type) {
      const dept = type === "hire"
        ? document.getElementById("hireDeptName").textContent
        : document.getElementById("dismissDeptName").textContent;
      const count = type === "hire"
        ? parseInt(document.getElementById("hireCount").value)
        : parseInt(document.getElementById("dismissCount").value);

      if (!confirm(`‚ö†Ô∏è Are you sure you want to ${type} ${count} staff in ${dept}?`)) return;

      const d = ACS.hr[dept];
      if (type === "hire") d.staff += count;
      else d.staff = Math.max(0, d.staff - count);

      if (type === "dismiss") {
        ACS.pendingEffects.push({ dept, effect: -10, triggerWeek: ACS.time.week + 1 });
      }

      renderTable();
      closeModal(type === "hire" ? "hireModal" : "dismissModal");
    }

    // === TIME ENGINE ===
    setInterval(() => {
      ACS.time.minute++;
      if (ACS.time.minute >= 60) { ACS.time.minute = 0; ACS.time.hour++; }
      if (ACS.time.hour >= 24) { ACS.time.hour = 0; ACS.time.day++; }
      if (ACS.time.day > 7) {
        ACS.time.day = 1;
        ACS.time.week++;
        checkWeeklyEffects();
      }
    }, 1000);

    function checkWeeklyEffects() {
      ACS.pendingEffects.forEach((ef, i) => {
        if (ef.triggerWeek === ACS.time.week) {
          const dept = ACS.hr[ef.dept];
          dept.morale = Math.max(0, Math.min(100, dept.morale + ef.effect));
          ACS.pendingEffects.splice(i, 1);
          renderTable();
        }
      });
    }

    function handleLogout() {
      alert("üëã Session closed. See you soon, Captain!");
      window.location.href = "login.html";
    }
  </script>
</body>
</html>
