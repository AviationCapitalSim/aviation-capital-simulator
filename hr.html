<!-- ============================================================
     === HR MODULE ‚Äî Qatar Luxury Edition | ACS ================
     === Version: v1 | Date: 25 NOV 2025 =======================
     ============================================================ -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Human Resources - Aviation Capital Simulator</title>

  <!-- ======== ACS Styles ======== -->
  <link rel="stylesheet" href="styles.css?v=3.1" />

  <!-- ======== ACS Favicons (16 / 32 / 64) ======== -->
  <link rel="icon" type="image/png" sizes="16x16" href="acs_logo_16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="acs_logo_32.png">
  <link rel="icon" type="image/png" sizes="64x64" href="acs_logo_64.png">

  <!-- ======== Apple iPhone/iPad Home Screen Icon ======== -->
  <link rel="apple-touch-icon" href="acs_logo_180.png">

  <!-- ======== PWA Manifest ======== -->
  <link rel="manifest" href="manifest.json">

  <style>
  /* ============================================================
       === ACS Qatar Luxury Dashboard ‚Äî Base Design ============
     ============================================================ */

  body {
    margin: 0;
    background-color: #081530;
    color: white;
    font-family: "Poppins", sans-serif;
  }

  /* ============================================================
       === GLOBAL HEADER (Exact Copy from index/dashboard) =====
     ============================================================ */

  .acs-header {
    position: fixed;
    top: 0;
    width: 100%;
    backdrop-filter: blur(9px);
    background: rgba(12,23,50,0.45);
    padding: 0.8rem 2rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 2px solid #ffb300;
    z-index: 5000;
  }

  .acs-left {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .acs-left img {
    height: 46px;
  }

  .acs-left h1 {
    font-size: 1.15rem;
    margin: 0;
    color: #ffb300;
    letter-spacing: 0.5px;
  }

  .acs-nav {
    flex: 1;
    display: flex;
    justify-content: center;
    gap: 2rem;
  }

  /* ============================================================
       === NAVIGATION ‚Äî QATAR PEARL GLOW STYLE =================
     ============================================================ */

  .acs-nav a {
    position: relative;
    font-size: 1rem;
    letter-spacing: 0.4px;
    color: #dbe4ff;
    text-decoration: none;
    transition: 0.25s ease;
    padding-bottom: 6px;
  }

  .acs-nav a:hover,
  .acs-nav a.active {
    color: #ffca3a;
    text-shadow: 0 0 6px rgba(255,179,0,0.45);
  }

  .acs-nav a.active::after,
  .acs-nav a:hover::after {
    content: "";
    position: absolute;
    bottom: -8px;
    left: 0;
    width: 100%;
    height: 2px;
    background: linear-gradient(to right, #ffb300, #ffe7a0);
    border-radius: 2px;
    box-shadow: 0 0 8px rgba(255,200,60,0.45);
  }

  .acs-right {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  /* LOGOUT BUTTON (Qatar style) */
  .logout-btn {
    padding: 0.45rem 1.1rem;
    border: 1px solid #ffb300;
    border-radius: 12px;
    background: rgba(255,179,0,0.05);
    color: #ffb300;
    font-weight: 600;
    cursor: pointer;
    text-decoration: none;
  }

  .logout-btn:hover {
    background: #ffb300;
    color: #0c1f3c;
  }

  /* CLOCK (same as dashboard) */
  .acs-clock-header {
    font-family: "Orbitron", monospace;
    padding: 0.4rem 0.8rem;
    background: rgba(0,255,128,0.08);
    border-radius: 8px;
    font-size: 0.95rem;
    color: #00ff80;
  }

  /* ============================================================
       === SUPPORT BUTTON (igual dashboard) =====================
     ============================================================ */

  .support-btn {
    padding: 0.45rem 1.1rem;
    border-radius: 12px;
    font-size: 0.9rem;
    font-weight: 600;
    text-decoration: none;
    cursor: pointer;
    color: #8AB4FF;
    border: 1px solid rgba(138,180,255,0.45);
    background: rgba(138,180,255,0.08);
    backdrop-filter: blur(6px);
    transition: 0.25s ease;
  }

  .support-btn:hover {
    background: rgba(138,180,255,0.20);
    box-shadow: 0 0 14px rgba(138,180,255,0.55);
    color: #dfe9ff;
  }

  /* ============================================================
       === MAIN CONTENT (igual dashboard) ======================
     ============================================================ */

  .acs-main {
    padding: 105px 2rem 70px;
    text-align: center;
  }

  .acs-main h2 {
    font-size: 1.9rem;
    font-weight: 600;
    color: #ffca3a;
    text-shadow: 0 0 12px rgba(255,190,60,0.55);
    letter-spacing: 0.6px;
    margin-top: 0.5rem;
  }

  .acs-main .sub {
    margin-top: 0.4rem;
    color: #cbd6ff;
    font-size: 1rem;
  }

  /* ============================================================
       === PANEL GRID (reuso dashboard-grid) ===================
     ============================================================ */

  .dashboard-grid {
    display: grid;
    gap: 2rem;
    margin-top: 2rem;
  }

  .row-business {
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  }

  /* Panel base (mismo que dashboard) */
  .panel {
  background: linear-gradient(180deg, rgba(20,35,70,0.75), rgba(10,18,40,0.85));
  padding: 1.6rem 1.5rem;
  border-radius: 22px;
  box-shadow: 0 0 25px rgba(0,0,0,0.4);
  transition: 0.25s;
  border: 1px solid rgba(255,179,0,0.15);
  text-align: center;     /* üî• todo centrado */
  align-items: center;     /* üî• asegura centro vertical si se usa flex */
}

  .panel:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 32px rgba(255,179,0,0.25);
    border: 1px solid rgba(255,179,0,0.35);
  }

  .panel h3 {
    font-size: 1.25rem;
    color: #ffb300;
    margin-bottom: 0.9rem;
    text-shadow: 0 0 6px rgba(255,179,0,0.4);
  }

  .panel p {
    color: #d7e2ff;
    font-size: 0.95rem;
    line-height: 1.4;
    margin: 0.15rem 0;
  }

  /* ============================================================
       === HR-SPECIFIC STYLES ==================================
     ============================================================ */

  .inactive-panel {
    opacity: 0.45;
    filter: grayscale(100%);
    pointer-events: none;
    position: relative;
  }

  .inactive-note {
    margin-top: 1rem;
    color: #aaa;
    font-style: italic;
    text-align: center;
  }

  /* Standard ACS button */
  .acs-btn {
    margin-top: 1rem;
    background: #00a86b;
    border: none;
    padding: 0.7rem 1.1rem;
    border-radius: 10px;
    cursor: pointer;
    font-weight: 600;
    transition: 0.25s;
    color: white;
  }

  .acs-btn:hover {
    background: #00794f;
  }

  /* Footer igual dashboard */
  .acs-footer {
    text-align: center;
    padding: 20px;
    margin-top: 50px;
    color: #7c8bb8;
    font-size: 0.9rem;
  }
  </style>
</head>

<body>

<header class="acs-header">
  <div class="acs-left">
    <img src="acs_logo.png" alt="ACS Logo">
    <h1>Aviation Capital Simulator</h1>
  </div>

  <nav class="acs-nav">
    <a href="dashboard.html">Main</a>
    <a href="finance.html">Bank</a>
    <a href="aircraft.html">Aircraft</a>
    <a href="routes.html">Routes</a>
    <a href="hr.html" class="active">HR</a>
    <a href="forum.html">Forum</a>
  </nav>

  <div class="acs-right">
    <a href="support.html" class="support-btn">Support</a>
    <a class="logout-btn" onclick="handleLogout()">Logout</a>
    <div class="acs-clock-header" id="acs-clock">00:00 ‚Äî 01 JAN 1940</div>
  </div>
</header>

<main class="acs-main">
  <h2>üë• Human Resources Department</h2>
  <p class="sub">Manage all staff, morale, payroll and bonuses across the company.</p>

  <div class="dashboard-grid row-business">

    <!-- === HR OVERVIEW === -->
    <div class="panel">
      <h3>üìä HR Overview</h3>
      <p>Total Staff: <strong id="totalStaff">‚Äî</strong></p>
      <p>Total Payroll: <strong id="totalPayroll">‚Äî</strong></p>
      <p>Average Morale: <strong id="avgMorale">‚Äî</strong></p>
      <p>Staff Coverage: <strong id="coverage">100%</strong></p>
    </div>

    <!-- === Department Control === -->
    <div class="panel">
      <h3>üßë‚Äçüíº Department Control</h3>
      <p>Total Departments: <strong>18</strong></p>
      <p>Total Staff: <strong id="totalStaff2">‚Äî</strong></p>
      <p>Average Morale: <strong id="avgMorale2">‚Äî</strong></p>
      <p>Monthly Payroll: <strong id="monthlyPayroll">‚Äî</strong></p>
      <button class="acs-btn" onclick="window.location.href='department_control.html'">
        üè¢ Open Department Control Center
      </button>
    </div>

    <!-- === Payroll & Bonuses (Coming Soon) === -->
    <div class="panel inactive-panel">
      <h3>üí∞ Payroll & Bonuses</h3>
      <p>This Month Payroll: <strong>‚Äî</strong></p>
      <p>Bonuses Applied: <strong>$0</strong></p>
      <p>Expense Share: <strong>‚Äî</strong></p>
      <p class="inactive-note">Coming Soon</p>
    </div>

    <!-- === Operational Impact (Coming Soon) === -->
    <div class="panel inactive-panel">
      <h3>‚úàÔ∏è Operational Impact</h3>
      <p>Flight Efficiency: <strong>‚Äî</strong></p>
      <p>Delay Risk: <strong>None</strong></p>
      <p>Maintenance Reliability: <strong>‚Äî</strong></p>
      <p class="inactive-note">Coming Soon</p>
    </div>

  </div>
</main>

<footer class="acs-footer">
  ¬© 2025 Aviation Capital Simulator. All rights reserved.
</footer>

<!-- ============================================================
     === SCRIPTS ‚Äî CORREGIDOS (Orden Obligatorio) ===============
     ============================================================ -->

<script src="engine/acs_alerts.js"></script>   <!-- üü¶ PRIMERO -->
<script src="time_engine.js"></script>
<script src="engine/acs_finance.js"></script>
<script src="engine/acs_hr_engine.js"></script>

<script>
/* ============================================================
   === HR DASHBOARD ‚Äî DATA LOADER =============================
   ============================================================ */
function loadHRDashboard() {
  const hr = ACS_HR_load();

  // Total staff
  const totalStaff = Object.values(hr).reduce((sum, d) => sum + d.staff, 0);

  // Average morale
  const morale = Math.round(
    Object.values(hr).reduce((sum, d) => sum + d.morale, 0) /
    Object.values(hr).length
  );

  // Total payroll
  const payroll = ACS_HR_getTotalPayroll();

  // Paint UI
  document.getElementById("totalStaff").textContent = totalStaff;
  document.getElementById("totalStaff2").textContent = totalStaff;

  document.getElementById("avgMorale").textContent = morale + "%";
  document.getElementById("avgMorale2").textContent = morale + "%";

  document.getElementById("totalPayroll").textContent =
    "$" + payroll.toLocaleString() + " / month";

  document.getElementById("monthlyPayroll").textContent =
    "$" + payroll.toLocaleString();
}

/* INIT */
window.addEventListener("DOMContentLoaded", () => {
  loadHRDashboard();

  if (typeof registerTimeListener === "function") {
    registerTimeListener(updateClockDisplay);
    updateClockDisplay();
  }
});

/* ============================================================
   üü¶ B4 ‚Äî AUTO-BALANCE STAFF ENGINE (HR_fullModal)
   ============================================================ */

function HR_autoAdjustFull() {
    if (!HR_active) return;

    const HR = ACS_HR_load();
    const d = HR[HR_active];
    if (!d) return;

    const required = d.required || d.staff;
    const current = d.staff;

    const diff = required - current;

    // Mostrar diferencia en el modal
    document.getElementById("autoDiff").textContent = diff;

    // === Caso 1: Falta personal ‚Üí contratar autom√°ticamente ===
    if (diff > 0) {
        ACS_HR_hire(HR_active, diff); 
        alert(`‚úÖ ${d.name}: Se contrataron autom√°ticamente ${diff} empleados.`);
    }

    // === Caso 2: Sobra personal ‚Üí confirmar despido ===
    else if (diff < 0) {

        const fireCount = Math.abs(diff);

        const ok = confirm(
            `‚ö†Ô∏è ${d.name}\n\nSobran ${fireCount} empleados.\n\n¬øDeseas despedirlos autom√°ticamente?`
        );

        if (ok) {
            ACS_HR_fire(HR_active, fireCount);
            alert(`‚ùå ${fireCount} empleados despedidos en ${d.name}.`);
        } else {
            return; // Cancelado
        }
    }

    // === Caso 3: est√° perfecto ===
    else {
        alert(`‚úîÔ∏è ${d.name} ya est√° perfectamente balanceado.`);
    }

    // Guardar y refrescar
    ACS_HR_recalculateAll();
    ACS_HR_save(HR);
    loadDepartments(); // refresca tabla grande
    openHRFullModal(HR_active); // reabre modal actualizado
}
     
</script>

</body>
</html>
